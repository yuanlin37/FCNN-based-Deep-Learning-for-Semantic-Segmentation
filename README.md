# FCNN-based Deep Learning for Semantic Segmentation

## Motivation
The purpose of this project is to investigate a type of Convolutional Neural Network (CNN), named Fully Convolutional Neural Network (FCNN), and we are going to apply this technique to the lane detection of self-driving car.

## Fully Convolutional Neural Network (FCNN)

## Reference
* More information about FCNN can be found in this paper.
* The code is modified based on this [repo](https://github.com/shekkizh/FCN.tensorflow). 
* Long, Jonathan, Evan Shelhamer, and Trevor Darrell. "Fully convolutional networks for semantic segmentation." In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pp. 3431-3440. 2015.
* [A briedf history of CNNs in image segmentation](https://blog.athelas.com/a-brief-history-of-cnns-in-image-segmentation-from-r-cnn-to-mask-r-cnn-34ea83205de4?gi=347ae9a5fb76)
* [A 2017 Guide to Semantic Segmentation with Deep Learning](http://blog.qure.ai/notes/semantic-segmentation-deep-learning-review)

## System Information
* Workstation HP Z840
* Win 10 OS
* Nvidia GPU 1080 Ti
* Python 3
* Tensorflow

## Notes
* I first tested the [ADE Challenge Dataset](http://data.csail.mit.edu/places/ADEchallenge/ADEChallengeData2016.zip), which contains about 151 labels, 20k labeled training images and 2k validation images. 
* It turned out the original code has some problems and it took me some time to debug/modify the code. Here are some of my observations:
 * As I use win 10 OS system, to make the original repo run, you need to modify this line
> [                filename = os.path.splitext(f.split("/")[-1])[0]](https://github.com/shekkizh/FCN.tensorflow/blob/27777723c62764fb69b031e79cfe8b50a80ca957/read_MITSceneParsingData.py#L54)
 
to 
> filename = os.path.basename(f)[:-4]. 
> 

Otherwise, the code cannot find the path of the annotation images.

* I started with the learning rate of 1e-4, but the final results do not look very good. The predicted annotation just show black background and no useful information. For the regions with labels, they are very noisy and are not connected to indicate an integrated segmentation region. 
* I reduced the learning rate to 1e-5, and now it seems the model begins to learn the training set gradually.
* Once thing needs to be noticed that 
* Some take home points from this project:
* The following figure is generated by the tensorboard of the tensorflow and shows the structure of this neural network. 
![](https://github.com/yuanlin37/Self-Driving_Car_Lane_Detection/blob/master/fig/20170928210527.jpg)
